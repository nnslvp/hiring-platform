# fetch-vacancies

Получает ID всех вакансий и содержимое их вложенных документов из базы данных Notion и сохраняет в JSON файл.

## Использование

```bash
python3 fetch_vacancies.py [output_file.json]
```

По умолчанию сохраняет данные в `vacancies.json`.

## Что делает команда

1. Получает все ID страниц из базы данных "Вакансии" (DATABASE_ID: `27c95810-6f37-8024-b175-d15ffe28f383`)
2. Обрабатывает пагинацию (максимум 100 записей за запрос)
3. Для каждой вакансии получает все вложенные документы (child_page)
4. Для каждого вложенного документа получает полное содержимое (все блоки)
5. Сохраняет ID основной страницы и содержимое вложенных документов в JSON файл
6. Выводит статистику

## Формат выходного файла

JSON файл содержит массив объектов, каждый из которых представляет одну вакансию:

```json
[
  {
    "page_id": "27c95810-6f37-8000-ada8-db237f784232",
    "child_pages": [
      {
        "page_id": "27c95810-6f37-80b1-b6d4-f63cb4cbafbf",
        "content": "Водительские права: CE, BDF\nПрицеп: Тентованный\nРегионы работы: По всей Европе\n..."
      },
      {
        "page_id": "27c95810-6f37-8041-8746-c80cb284af1c",
        "content": "Текст содержимого второго документа..."
      }
    ]
  },
  {
    "page_id": "27c95810-6f37-8020-9a3d-f0d85b5b9557",
    "child_pages": []
  }
]
```

## Особенности

- Сохраняет ID основной страницы вакансии и текстовое содержимое всех вложенных документов
- `page_id` - ID основной страницы вакансии
- `child_pages` - массив объектов, каждый содержит:
  - `page_id` - ID вложенной страницы
  - `content` - строка с чистым текстом содержимого страницы (без разметки и структуры блоков)
- Если вложенных документов нет, массив будет пустым `[]`
- Содержимое извлекается как чистый текст из всех текстовых блоков страницы

## Статистика

После выполнения команда выводит:
- Общее количество вакансий
- Общее количество вложенных документов
- Количество вакансий с вложенными документами
