#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π —á–µ—Ä–µ–∑ GPT-4o mini —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï:
  python3 process_with_gpt.py [--batch-size N] [--start-from N] [--vacancies-file FILE] [--output-dir DIR]

–ü–ê–†–ê–ú–ï–¢–†–´:
  --batch-size N        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞ —Ä–∞–∑ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5)
  --start-from N        –ù–∞—á–∞—Ç—å —Å –≤–∞–∫–∞–Ω—Å–∏–∏ –Ω–æ–º–µ—Ä N (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0)
  --vacancies-file FILE –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –≤–∞–∫–∞–Ω—Å–∏—è–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: vacancies.json)
  --output-dir DIR      –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: patches/)

–ü–†–ò–ú–ï–†:
  python3 process_with_gpt.py --batch-size 10 --start-from 5

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
  pip install openai
"""

import json
import os
import sys
import argparse
from openai import OpenAI
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env —Ñ–∞–π–ª–∞
load_dotenv()

OPENAI_API_KEY = os.getenv('OPENAI_API_KEY')

if not OPENAI_API_KEY:
    print("‚ùå –û—à–∏–±–∫–∞: –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è OPENAI_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞")
    print("–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–ª—é—á–∏")
    sys.exit(1)

try:
    client = OpenAI(api_key=OPENAI_API_KEY)
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ OpenAI –∫–ª–∏–µ–Ω—Ç–∞: {e}")
    print("–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É: pip install openai")
    sys.exit(1)

# –°—Ç—Ä–æ–≥–∞—è JSON Schema –¥–ª—è –æ—Ç–≤–µ—Ç–∞ GPT
RESPONSE_SCHEMA = {
    "type": "object",
    "properties": {
        "page_id": {
            "type": "string",
            "description": "ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–∞–∫–∞–Ω—Å–∏–∏ –≤ Notion"
        },
        "properties": {
            "type": "object",
            "properties": {
                "–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∞–≤": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": ["CE", "C", "C1", "B", "BDF", "D", "D1"]
                    },
                    "description": "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤"
                },
                "–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "–¢–µ–Ω—Ç", "–†–µ—Ñ (—Ä–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä)", "BDF", "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã",
                            "–¶–∏—Å—Ç–µ—Ä–Ω–∞", "–ò–∑–æ—Ç–µ—Ä–º–∞", "–®—Ç–æ—Ä–∞", "–°–∞–º–æ—Å–≤–∞–ª",
                            "–¢–∞–Ω–¥–µ–º", "–ü–æ–¥–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–π –ø—Ä–∏—Ü–µ–ø"
                        ]
                    },
                    "description": "–¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏ –ø—Ä–∏—Ü–µ–ø–∞"
                },
                "–†–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã"
                },
                "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç (–º–µ—Å—è—Ü—ã)": {
                    "type": ["number", "null"],
                    "description": "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–µ–±—É–µ–º—ã–π –æ–ø—ã—Ç –≤ –º–µ—Å—è—Ü–∞—Ö"
                },
                "–ö–æ–¥ 95": {
                    "type": ["string", "null"],
                    "enum": ["–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ", "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ", "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", None],
                    "description": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏"
                },
                "ADR": {
                    "type": ["string", "null"],
                    "enum": ["–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ", "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ", "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", None],
                    "description": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é –Ω–∞ –ø–µ—Ä–µ–≤–æ–∑–∫—É –æ–ø–∞—Å–Ω—ã—Ö –≥—Ä—É–∑–æ–≤"
                },
                "–¢–∏–ø –æ–ø–ª–∞—Ç—ã": {
                    "type": ["string", "null"],
                    "enum": ["–ü–æ–¥–µ–Ω–Ω–∞—è", "–ú–µ—Å—è—á–Ω–∞—è", "–ù–µ —É–∫–∞–∑–∞–Ω–æ", None],
                    "description": "–¢–∏–ø —Å–∏—Å—Ç–µ–º—ã –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞"
                },
                "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)": {
                    "type": ["number", "null"],
                    "description": "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –æ–ø–ª–∞—Ç—ã"
                },
                "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)": {
                    "type": ["number", "null"],
                    "description": "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –æ–ø–ª–∞—Ç—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞)"
                },
                "–í–∞–ª—é—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã": {
                    "type": ["string", "null"],
                    "enum": ["PLN", "EUR", "–ù–µ —É–∫–∞–∑–∞–Ω–æ", None],
                    "description": "–í–∞–ª—é—Ç–∞ –æ–ø–ª–∞—Ç—ã"
                },
                "–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞": {
                    "type": ["string", "null"],
                    "enum": ["UMOWA O PRACƒò", "UMOWA ZLECENIE", "B2B", "–ù–µ —É–∫–∞–∑–∞–Ω–æ", None],
                    "description": "–¢–∏–ø —Ç—Ä—É–¥–æ–≤–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞"
                },
                "–ö–∞—Ä—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª—è": {
                    "type": ["string", "null"],
                    "enum": ["–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ", "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ", "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", None],
                    "description": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ –∫–∞—Ä—Ç–µ –≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è —Ç–∞—Ö–æ–≥—Ä–∞—Ñ–∞"
                }
            },
            "required": [
                "–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∞–≤", "–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏", "–†–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã",
                "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç (–º–µ—Å—è—Ü—ã)", "–ö–æ–¥ 95", "ADR",
                "–¢–∏–ø –æ–ø–ª–∞—Ç—ã", "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)",
                "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)", "–í–∞–ª—é—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã",
                "–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞", "–ö–∞—Ä—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª—è"
            ],
            "additionalProperties": False
        }
    },
    "required": ["page_id", "properties"],
    "additionalProperties": False
}

SYSTEM_PROMPT = """–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –æ –≤–∞–∫–∞–Ω—Å–∏—è—Ö –≤–æ–¥–∏—Ç–µ–ª–µ–π.

–¢–≤–æ—è –∑–∞–¥–∞—á–∞: –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏ –∏ –∏–∑–≤–ª–µ—á—å 12 –ø–æ–ª–µ–π —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º.

–í–ê–ñ–ù–û –û –°–¢–†–£–ö–¢–£–†–ï –î–û–ö–£–ú–ï–ù–¢–ê:
–í–∞–∫–∞–Ω—Å–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç 2 –¥–æ–∫—É–º–µ–Ω—Ç–∞:
1. "–í–∞–∫–∞–Ω—Å–∏—è" - –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç —Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ò–°–ü–û–õ–¨–ó–£–ô –¢–û–õ–¨–ö–û –ï–ì–û)
2. "–ü–æ—Å—Ç" - —Ç–µ–∫—Å—Ç –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö —Å —ç–º–æ–¥–∑–∏ (–ò–ì–ù–û–†–ò–†–£–ô –ï–ì–û)

–ò–∑–≤–ª–µ–∫–∞–π –¥–∞–Ω–Ω—ã–µ –¢–û–õ–¨–ö–û –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏. 
–ò–≥–Ω–æ—Ä–∏—Ä—É–π –ª—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–¥–µ–ª–æ–≤ —Å —ç–º–æ–¥–∑–∏ (üöõ, üí∂, ‚úÖ –∏ —Ç.–¥.) - —ç—Ç–æ –ø–æ—Å—Ç –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π.

–ü–†–ê–í–ò–õ–ê –ò–ó–í–õ–ï–ß–ï–ù–ò–Ø –ü–û–õ–ï–ô:

1. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∞–≤** (multi_select, –º–∞—Å—Å–∏–≤):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞:" –≤ —Ä–∞–∑–¥–µ–ª–µ "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—É"
   –û–ø—Ü–∏–∏: CE, C, C1, B, BDF, D, D1
   –ü—Ä–∞–≤–∏–ª–∞:
   - –ò–∑–≤–ª–µ—á—å –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞
   - –†–∞–∑–¥–µ–ª–∏—Ç—å –ø–æ –∑–∞–ø—è—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ
   - –£–±—Ä–∞—Ç—å —Å–ª–æ–≤–æ "–ö–∞—Ç–µ–≥–æ—Ä–∏—è" –∏ –ø—Ä–æ–±–µ–ª—ã
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–ö–∞—Ç–µ–≥–æ—Ä–∏—è CE, BDF" ‚Üí ["CE", "BDF"]
   - "–ö–∞—Ç–µ–≥–æ—Ä–∏—è CE" ‚Üí ["CE"]
   - "–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞: –ö–∞—Ç–µ–≥–æ—Ä–∏—è B" ‚Üí ["B"]

2. **–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏** (multi_select, –º–∞—Å—Å–∏–≤):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–ü—Ä–∏—Ü–µ–ø:", "–ê–≤—Ç–æ–º–æ–±–∏–ª—å:", –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ (–º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–∏–ø –≤ —Å–∫–æ–±–∫–∞—Ö)
   –û–ø—Ü–∏–∏: –¢–µ–Ω—Ç, –†–µ—Ñ (—Ä–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä), BDF, –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –¶–∏—Å—Ç–µ—Ä–Ω–∞, –ò–∑–æ—Ç–µ—Ä–º–∞, –®—Ç–æ—Ä–∞, –°–∞–º–æ—Å–≤–∞–ª, –¢–∞–Ω–¥–µ–º, –ü–æ–¥–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–π –ø—Ä–∏—Ü–µ–ø
   –ü—Ä–∞–≤–∏–ª–∞:
   - –ö–†–ò–¢–ò–ß–ù–û: –ò–∑–≤–ª–µ–∫–∞–π –¢–û–õ–¨–ö–û —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–∏–ø, –ù–ï —É–≥–∞–¥—ã–≤–∞–π!
   - –ò—â–∏ –≤ –±–ª–æ–∫–µ "–ü—Ä–∏—Ü–µ–ø:" —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "–¢–µ–Ω—Ç–æ–≤–∞–Ω–Ω—ã–π" –∏–ª–∏ "—Ç–µ–Ω—Ç" (–≤ –±–ª–æ–∫–µ –ü—Ä–∏—Ü–µ–ø) ‚Üí "–¢–µ–Ω—Ç"
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "–†–µ—Ñ" –∏–ª–∏ "—Ä–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä" –∏–ª–∏ "—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫" ‚Üí "–†–µ—Ñ (—Ä–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä)"
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "BDF" ‚Üí "BDF"
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "–¢–∞–Ω–¥–µ–º" ‚Üí "–¢–∞–Ω–¥–µ–º"
   - –ï—Å–ª–∏ "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π", "—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π", "–ù–µ—Ç", "–Ω–µ —É–∫–∞–∑–∞–Ω–æ", "–æ–±—ã—á–Ω—ã–π" ‚Üí [] (–ü–£–°–¢–û–ô –º–∞—Å—Å–∏–≤!)
   - –î–ª—è —Ñ—É—Ä–≥–æ–Ω–æ–≤ (Renault Master, Sprinter –∏ —Ç.–¥.) –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ ‚Üí []
   - –ù–ï –¥–æ–±–∞–≤–ª—è–π —Ç–∏–ø—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ —Ö—ç—à—Ç–µ–≥–æ–≤
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–ü—Ä–∏—Ü–µ–ø: BDF" ‚Üí ["BDF"]
   - "–ü—Ä–∏—Ü–µ–ø: –¢–µ–Ω—Ç–æ–≤–∞–Ω–Ω—ã–π" ‚Üí ["–¢–µ–Ω—Ç"]
   - "–ü—Ä–∏—Ü–µ–ø: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π" ‚Üí []
   - "–ü—Ä–∏—Ü–µ–ø: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π, –¥–æ 5 –ª–µ—Ç" ‚Üí []
   - "–ü—Ä–∏—Ü–µ–ø: –ù–µ—Ç" ‚Üí []
   - "–ê–≤—Ç–æ–º–æ–±–∏–ª—å: Renault Master" ‚Üí []

3. **–†–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã** (multi_select, –º–∞—Å—Å–∏–≤):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–†–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã:" –∏–ª–∏ "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã/—Ä–µ–≥–∏–æ–Ω—ã:"
   
   –í–ê–ñ–ù–û - –ù–ê–ó–í–ê–ù–ò–Ø –°–¢–†–ê–ù:
   - –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –†–£–°–°–ö–ò–ï –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω
   - –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è - –ü–ï–†–ï–í–û–î–ò –∏—Ö –Ω–∞ —Ä—É—Å—Å–∫–∏–π
   - –ù–∞–ø—Ä–∏–º–µ—Ä: "Niemcy" ‚Üí "–ì–µ—Ä–º–∞–Ω–∏—è", "Francja" ‚Üí "–§—Ä–∞–Ω—Ü–∏—è", "Anglia" ‚Üí "–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è", "W≈Çochy" ‚Üí "–ò—Ç–∞–ª–∏—è"
   
   –ë–∞–∑–æ–≤—ã–µ –æ–ø—Ü–∏–∏: –ü–æ–ª—å—à–∞, –ü–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ, –°–∫–∞–Ω–¥–∏–Ω–∞–≤–∏—è, –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è, –ì–µ—Ä–º–∞–Ω–∏—è, –§—Ä–∞–Ω—Ü–∏—è, –ò—Ç–∞–ª–∏—è, –ò—Å–ø–∞–Ω–∏—è, –ë–µ–Ω–∏–ª—é–∫—Å, –ß–µ—Ö–∏—è, –°–ª–æ–≤–∞–∫–∏—è, –ê–≤—Å—Ç—Ä–∏—è, –í–µ–Ω–≥—Ä–∏—è, –õ–∏—Ç–≤–∞, –õ–∞—Ç–≤–∏—è, –≠—Å—Ç–æ–Ω–∏—è, –°–ª–æ–≤–µ–Ω–∏—è, –ì—Ä–µ—Ü–∏—è, –ë–æ–ª–≥–∞—Ä–∏—è, –î–∞–Ω–∏—è, –®–≤–µ—Ü–∏—è, –§–∏–Ω–ª—è–Ω–¥–∏—è, –ù–æ—Ä–≤–µ–≥–∏—è, –®–≤–µ–π—Ü–∞—Ä–∏—è, –†—É–º—ã–Ω–∏—è, –•–æ—Ä–≤–∞—Ç–∏—è, –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã, –ë–µ–ª—å–≥–∏—è, –õ—é–∫—Å–µ–º–±—É—Ä–≥, –ü–æ—Ä—Ç—É–≥–∞–ª–∏—è, –í–æ—Å—Ç–æ—á–Ω–∞—è –ï–≤—Ä–æ–ø–∞, –ó–∞–ø–∞–¥–Ω–∞—è –ï–≤—Ä–æ–ø–∞
   
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–ø–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ", "–≤—Å—è –ï–≤—Ä–æ–ø–∞", "EU", "UE", "–ï–≤—Ä–æ–ø–∞", "–ø–æ –ï–°" ‚Üí ["–ü–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ"]
   - –ï—Å–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã —Å—Ç—Ä–∞–Ω—ã ‚Üí –∏–∑–≤–ª–µ—á—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–∞–Ω—É –û–¢–î–ï–õ–¨–ù–û –Ω–∞ –†–£–°–°–ö–û–ú —è–∑—ã–∫–µ
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ª—é–±—ã–µ —Å—Ç—Ä–∞–Ω—ã/—Ä–µ–≥–∏–æ–Ω—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ, –ù–û –¢–û–õ–¨–ö–û –ù–ê –†–£–°–°–ö–û–ú
   
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–ø–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ" ‚Üí ["–ü–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ"]
   - "Niemcy, Francja" ‚Üí ["–ì–µ—Ä–º–∞–Ω–∏—è", "–§—Ä–∞–Ω—Ü–∏—è"]
   - "–ì–µ—Ä–º–∞–Ω–∏—è, –ß–µ—Ö–∏—è, –ê–≤—Å—Ç—Ä–∏—è, –ü–æ–ª—å—à–∞" ‚Üí ["–ì–µ—Ä–º–∞–Ω–∏—è", "–ß–µ—Ö–∏—è", "–ê–≤—Å—Ç—Ä–∏—è", "–ü–æ–ª—å—à–∞"]

4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç (–º–µ—Å—è—Ü—ã)** (number):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã:" –∏–ª–∏ "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã:" –≤ —Ä–∞–∑–¥–µ–ª–µ "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—É"
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–ü–æ–ª–≥–æ–¥–∞" ‚Üí 6
   - "6 –º–µ—Å—è—Ü–µ–≤" ‚Üí 6
   - "1 –≥–æ–¥" ‚Üí 12
   - "2 –≥–æ–¥–∞" ‚Üí 24
   - "3 –≥–æ–¥–∞" ‚Üí 36
   - "–ñ–µ–ª–∞—Ç–µ–ª–µ–Ω 6 –º–µ—Å—è—Ü–µ–≤" ‚Üí 6 (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ –∫–∞–∫ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –≤—Å–µ —Ä–∞–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å)
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

5. **–ö–æ–¥ 95** (select, —Å—Ç—Ä–æ–∫–∞):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–æ–¥ 95):"
   –û–ø—Ü–∏–∏: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
   - "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ"
   - "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è" –∏–ª–∏ "–ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è" ‚Üí "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è"
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

6. **ADR** (select, —Å—Ç—Ä–æ–∫–∞):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "ADR (–æ–ø–∞—Å–Ω—ã–µ –≥—Ä—É–∑—ã):" –∏–ª–∏ "ADR (–ø–µ—Ä–µ–≤–æ–∑–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö –≥—Ä—É–∑–æ–≤):"
   –û–ø—Ü–∏–∏: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
   - "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ" –∏–ª–∏ "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ"
   - "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è" ‚Üí "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è"
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

7. **–¢–∏–ø –æ–ø–ª–∞—Ç—ã** (select, —Å—Ç—Ä–æ–∫–∞):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–°–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã:" –∏–ª–∏ "–û–ø–ª–∞—Ç–∞:" –≤ —Ä–∞–∑–¥–µ–ª–µ –æ–ø–ª–∞—Ç—ã
   –û–ø—Ü–∏–∏: –ü–æ–¥–µ–Ω–Ω–∞—è, –ú–µ—Å—è—á–Ω–∞—è, –ù–µ —É–∫–∞–∑–∞–Ω–æ
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–ü–æ–¥–µ–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞", "–¥–Ω–∏√≥wka", "–∑–∞ –¥–µ–Ω—å", "–≤ –¥–µ–Ω—å", "/–¥–µ–Ω—å", "/dzien" ‚Üí "–ü–æ–¥–µ–Ω–Ω–∞—è"
   - "–ï–∂–µ–º–µ—Å—è—á–Ω–∞—è", "–†–∞–∑ –≤ –º–µ—Å—è—Ü", "–≤ –º–µ—Å—è—Ü", "–∑–∞ –º–µ—Å—è—Ü", "–º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞" ‚Üí "–ú–µ—Å—è—á–Ω–∞—è"
   - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ –¥–Ω–µ–≤–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ ‚Üí "–ü–æ–¥–µ–Ω–Ω–∞—è"
   - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ –º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ ‚Üí "–ú–µ—Å—è—á–Ω–∞—è"
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí "–ù–µ —É–∫–∞–∑–∞–Ω–æ"

8. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)** (number):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–û–ø–ª–∞—Ç–∞:", "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞:", "–°—Ä–µ–¥–Ω—è—è –º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ):", "–°–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã:"
   –ü—Ä–∞–≤–∏–ª–∞:
   - –í–ê–ñ–ù–û: –ò–∑–≤–ª–µ–∫–∞–π –∑–∞—Ä–ø–ª–∞—Ç—É –¢–û–õ–¨–ö–û –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –∑–∞—Ä–ø–ª–∞—Ç—ã, –ù–ï –∏–∑ –ø–æ—Å—Ç–æ–≤ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π
   - –ò—â–∏ —á–∏—Å–ª–∞ —Ä—è–¥–æ–º —Å–æ —Å–ª–æ–≤–∞–º–∏ "–∑–ª–æ—Ç—ã—Ö", "z≈Ç", "‚Ç¨", "EUR", "–Ω–µ—Ç—Ç–æ", "—Å—Ç–∞–≤–∫–∞", "–∑–∞—Ä–ø–ª–∞—Ç–∞"
   - –ï—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω (300-320) ‚Üí –≤–∑—è—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (300)
   - –î–ª—è –ø–æ–¥–µ–Ω–Ω–æ–π: –∏–∑ "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞:" –∏–ª–∏ "–ü–æ–¥–µ–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞"
   - –î–ª—è –º–µ—Å—è—á–Ω–æ–π: –∏–∑ "–°—Ä–µ–¥–Ω—è—è –º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ):"
   - –ò–≥–Ω–æ—Ä–∏—Ä—É–π –∑–∞—Ä–ø–ª–∞—Ç—É –∏–∑ –±–ª–æ–∫–æ–≤ "–ü–æ—Å—Ç" –∏–ª–∏ —Å–µ–∫—Ü–∏–π —Å —ç–º–æ–¥–∑–∏
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞: 430 –ø–æ–ª—å—Å–∫–∏—Ö –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ –∑–∞ –¥–µ–Ω—å" ‚Üí 430
   - "–ü–æ–¥–µ–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞ ‚Äì 450 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí 450
   - "300-320 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí 300
   - "95‚Ç¨/–¥–µ–Ω—å" ‚Üí 95
   - "3000 –µ–≤—Ä–æ –∑–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Ä–∞–±–æ—Ç—É" ‚Üí 3000

9. **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)** (number –∏–ª–∏ null):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –¢–æ—Ç –∂–µ, —á—Ç–æ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è
   –ü—Ä–∞–≤–∏–ª–∞:
   - –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
   - –ï—Å–ª–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ ‚Üí null
   - –ï—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω ‚Üí –∏–∑–≤–ª–µ—á—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
   –ü—Ä–∏–º–µ—Ä—ã:
   - "300-320 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí 320
   - "400-450 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí 450
   - "450 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí null

10. **–í–∞–ª—é—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã** (select, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–û–ø–ª–∞—Ç–∞:", "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞:", "–°—Ä–µ–¥–Ω—è—è –º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ):"
    –û–ø—Ü–∏–∏: PLN, EUR, –ù–µ —É–∫–∞–∑–∞–Ω–æ
    –ü—Ä–∞–≤–∏–ª–∞:
    - –í–ê–ñ–ù–û: –û–ø—Ä–µ–¥–µ–ª—è–π –≤–∞–ª—é—Ç—É –¢–û–õ–¨–ö–û –∏–∑ –±–ª–æ–∫–æ–≤ —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π, –∏–≥–Ω–æ—Ä–∏—Ä—É–π –≤–∞–ª—é—Ç—É –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö —Ç–µ–∫—Å—Ç–∞ (–ø–æ—Å—Ç—ã, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)
    - "–∑–ª–æ—Ç—ã—Ö", "z≈Ç", "PLN", "–ø–æ–ª—å—Å–∫–∏—Ö –∑–ª–æ—Ç—ã—Ö" –≤ –±–ª–æ–∫–∞—Ö –∑–∞—Ä–ø–ª–∞—Ç—ã ‚Üí "PLN"
    - "‚Ç¨", "EUR", "–µ–≤—Ä–æ", "euro" –≤ –±–ª–æ–∫–∞—Ö –∑–∞—Ä–ø–ª–∞—Ç—ã ‚Üí "EUR"
    - –ï—Å–ª–∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞ ‚Üí "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
    –ü—Ä–∏–º–µ—Ä—ã:
    - "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞: 430 –ø–æ–ª—å—Å–∫–∏—Ö –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ –∑–∞ –¥–µ–Ω—å" ‚Üí "PLN"
    - "300-320 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí "PLN"
    - "95‚Ç¨/–¥–µ–Ω—å" ‚Üí "EUR"

11. **–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞** (select, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞:" –≤ –Ω–∞—á–∞–ª–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    –û–ø—Ü–∏–∏: UMOWA O PRACƒò, UMOWA ZLECENIE, B2B, –ù–µ —É–∫–∞–∑–∞–Ω–æ
    –ü—Ä–∞–≤–∏–ª–∞:
    - "UMOWA O PRACƒò" –∏–ª–∏ "–¢—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä" –∏–ª–∏ "umowa o pracƒô" –∏–ª–∏ "UOP" ‚Üí "UMOWA O PRACƒò"
    - "UMOWA ZLECENIE" –∏–ª–∏ "UZ" ‚Üí "UMOWA ZLECENIE"
    - "B2B" ‚Üí "B2B"
    - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí "–ù–µ —É–∫–∞–∑–∞–Ω–æ"

12. **–ö–∞—Ä—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª—è** (select, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–ö–∞—Ä—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª—è (–¥–ª—è —Ç–∞—Ö–æ–≥—Ä–∞—Ñ–∞):" –≤ —Ä–∞–∑–¥–µ–ª–µ "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—É"
    –û–ø—Ü–∏–∏: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
    –ü—Ä–∞–≤–∏–ª–∞:
    - "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
    - "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ"
    - "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è" –∏–ª–∏ "–ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è" ‚Üí "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è"
    - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

–û–ë–©–ò–ï –ü–†–ê–í–ò–õ–ê:
- –ï—Å–ª–∏ –±–ª–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí null
- –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ "–ù–µ —É–∫–∞–∑–∞–Ω–æ" –∏–ª–∏ "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" ‚Üí null
- –î–ª—è multi_select (–º–∞—Å—Å–∏–≤—ã): –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí []
- –î–ª—è select (—Å—Ç—Ä–æ–∫–∏): –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí null
- –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ ‚Üí –≤—ã–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π
- –°—Ç—Ä–æ–≥–æ —Å–ª–µ–¥—É–π —Å—Ö–µ–º–µ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–ø—Ü–∏—è–º
"""

def call_openai_api(vacancy_data, page_id):
    """–í—ã–∑—ã–≤–∞–µ—Ç OpenAI API –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏ –∏–∑ child_pages
    vacancy_text = ""
    for idx, child_page in enumerate(vacancy_data.get('child_pages', []), 1):
        content = child_page.get('content', '')
        vacancy_text += f"\n\n=== –î–æ–∫—É–º–µ–Ω—Ç {idx} ===\n{content}"
    
    if not vacancy_text.strip():
        print(f"  ‚ö†Ô∏è  –ü—É—Å—Ç–∞—è –≤–∞–∫–∞–Ω—Å–∏—è, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
        return None
    
    user_message = f"–í–∞–∫–∞–Ω—Å–∏—è ID: {page_id}\n{vacancy_text}"
    
    try:
        response = client.beta.chat.completions.parse(
            model="gpt-4o-mini",
            messages=[
                {"role": "system", "content": SYSTEM_PROMPT},
                {"role": "user", "content": user_message}
            ],
            temperature=0.1,
            response_format={
                "type": "json_schema",
                "json_schema": {
                    "name": "vacancy_extraction",
                    "strict": True,
                    "schema": RESPONSE_SCHEMA
                }
            }
        )
        
        content = response.choices[0].message.content
        extracted_data = json.loads(content)
        
        # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ page_id –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
        extracted_data['page_id'] = page_id
        
        return extracted_data
        
    except Exception as e:
        print(f"  ‚ùå –û—à–∏–±–∫–∞ API: {e}")
        if hasattr(e, 'response'):
            try:
                print(f"  –î–µ—Ç–∞–ª–∏: {e.response.text}")
            except:
                pass
        return None

def main():
    parser = argparse.ArgumentParser(description='–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π —á–µ—Ä–µ–∑ GPT-4o mini')
    parser.add_argument('--batch-size', type=int, default=5, help='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞ —Ä–∞–∑')
    parser.add_argument('--start-from', type=int, default=0, help='–ù–∞—á–∞—Ç—å —Å –≤–∞–∫–∞–Ω—Å–∏–∏ –Ω–æ–º–µ—Ä N')
    parser.add_argument('--vacancies-file', default='vacancies.json', help='–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –≤–∞–∫–∞–Ω—Å–∏—è–º–∏')
    parser.add_argument('--output-dir', default='patches/', help='–ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤')
    
    args = parser.parse_args()
    
    # –°–æ–∑–¥–∞–µ–º –≤—ã—Ö–æ–¥–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
    os.makedirs(args.output_dir, exist_ok=True)
    
    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —Å –≤–∞–∫–∞–Ω—Å–∏—è–º–∏
    print(f"üì• –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π –∏–∑ {args.vacancies_file}...")
    try:
        with open(args.vacancies_file, 'r', encoding='utf-8') as f:
            vacancies = json.load(f)
    except FileNotFoundError:
        print(f"‚ùå –§–∞–π–ª {args.vacancies_file} –Ω–µ –Ω–∞–π–¥–µ–Ω")
        sys.exit(1)
    except json.JSONDecodeError as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: {e}")
        sys.exit(1)
    
    total_vacancies = len(vacancies)
    print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {total_vacancies} –≤–∞–∫–∞–Ω—Å–∏–π")
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏
    start_idx = args.start_from
    end_idx = min(start_idx + args.batch_size, total_vacancies)
    
    if start_idx >= total_vacancies:
        print(f"‚ùå –ò–Ω–¥–µ–∫—Å –Ω–∞—á–∞–ª–∞ ({start_idx}) –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤–∞–∫–∞–Ω—Å–∏–π ({total_vacancies})")
        sys.exit(1)
    
    print(f"\nüîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π —Å {start_idx} –ø–æ {end_idx - 1} (–±–∞—Ç—á —Ä–∞–∑–º–µ—Ä–æ–º {args.batch_size})")
    print(f"üìÇ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {args.output_dir}\n")
    
    success_count = 0
    error_count = 0
    
    for idx in range(start_idx, end_idx):
        vacancy = vacancies[idx]
        page_id = vacancy.get('page_id')
        
        if not page_id:
            print(f"‚ö†Ô∏è  –í–∞–∫–∞–Ω—Å–∏—è {idx + 1}/{total_vacancies}: –Ω–µ—Ç page_id, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
            error_count += 1
            continue
        
        print(f"üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ {idx + 1}/{total_vacancies}: {page_id[:8]}...")
        
        # –í—ã–∑—ã–≤–∞–µ–º GPT API
        result = call_openai_api(vacancy, page_id)
        
        if result:
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–∞–π–ª
            output_file = os.path.join(args.output_dir, f"vacancy-{page_id}.json")
            try:
                with open(output_file, 'w', encoding='utf-8') as f:
                    json.dump(result, f, ensure_ascii=False, indent=2)
                print(f"  ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ {output_file}")
                success_count += 1
            except Exception as e:
                print(f"  ‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {e}")
                error_count += 1
        else:
            error_count += 1
    
    print(f"\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    print(f"  ‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {success_count}")
    print(f"  ‚ùå –û—à–∏–±–æ–∫: {error_count}")
    print(f"  üì¶ –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {end_idx - start_idx}")
    
    if end_idx < total_vacancies:
        print(f"\nüí° –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–∞—Ç—á–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:")
        print(f"   python3 process_with_gpt.py --start-from {end_idx} --batch-size {args.batch_size}")
    else:
        print(f"\nüéâ –í—Å–µ –≤–∞–∫–∞–Ω—Å–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã!")

if __name__ == "__main__":
    main()

