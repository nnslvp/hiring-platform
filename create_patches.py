#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π —á–µ—Ä–µ–∑ GPT-4o mini —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï:
  python3 process_with_gpt.py [--batch-size N] [--start-from N] [--vacancies-file FILE] [--output-dir DIR]

–ü–ê–†–ê–ú–ï–¢–†–´:
  --batch-size N        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞ —Ä–∞–∑ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5)
  --start-from N        –ù–∞—á–∞—Ç—å —Å –≤–∞–∫–∞–Ω—Å–∏–∏ –Ω–æ–º–µ—Ä N (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0)
  --vacancies-file FILE –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –≤–∞–∫–∞–Ω—Å–∏—è–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: vacancies.json)
  --output-dir DIR      –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: patches/)

–ü–†–ò–ú–ï–†:
  python3 process_with_gpt.py --batch-size 10 --start-from 5

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
  pip install openai
"""

import json
import os
import sys
import argparse
import time
from concurrent.futures import ThreadPoolExecutor, as_completed
from openai import OpenAI
from dotenv import load_dotenv

from field_definitions import (
    LICENSE_CATEGORIES,
    REQUIREMENT_LEVEL,
    CREW_TYPE,
    VEHICLE_TYPES,
    PAYMENT_TYPE,
    SALARY_CURRENCY,
    CONTRACT_TYPE,
    POLISH_REQUIREMENT,
)

load_dotenv()

OPENAI_API_KEY = os.getenv('OPENAI_API_KEY')

if not OPENAI_API_KEY:
    print("‚ùå –û—à–∏–±–∫–∞: –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è OPENAI_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞")
    print("–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–ª—é—á–∏")
    sys.exit(1)

try:
    client = OpenAI(api_key=OPENAI_API_KEY)
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ OpenAI –∫–ª–∏–µ–Ω—Ç–∞: {e}")
    print("–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É: pip install openai")
    sys.exit(1)

# –°—Ç—Ä–æ–≥–∞—è JSON Schema –¥–ª—è –æ—Ç–≤–µ—Ç–∞ GPT
RESPONSE_SCHEMA = {
    "type": "object",
    "properties": {
        "page_id": {
            "type": "string",
            "description": "ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–∞–∫–∞–Ω—Å–∏–∏ –≤ Notion"
        },
        "properties": {
            "type": "object",
            "properties": {
                "–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∞–≤": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": LICENSE_CATEGORIES
                    },
                    "description": "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤ (—Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –í–£, –±–µ–∑ BDF)"
                },
                "–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": VEHICLE_TYPES
                    },
                    "description": "–¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏ –ø—Ä–∏—Ü–µ–ø–∞ (BDF - —ç—Ç–æ —Ç–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏, –Ω–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∞–≤)"
                },
                "–†–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã"
                },
                "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç (–º–µ—Å—è—Ü—ã)": {
                    "type": ["number", "null"],
                    "description": "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–µ–±—É–µ–º—ã–π –æ–ø—ã—Ç –≤ –º–µ—Å—è—Ü–∞—Ö"
                },
                "–ö–æ–¥ 95": {
                    "type": ["string", "null"],
                    "enum": REQUIREMENT_LEVEL + [None],
                    "description": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏"
                },
                "ADR": {
                    "type": ["string", "null"],
                    "enum": REQUIREMENT_LEVEL + [None],
                    "description": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é –Ω–∞ –ø–µ—Ä–µ–≤–æ–∑–∫—É –æ–ø–∞—Å–Ω—ã—Ö –≥—Ä—É–∑–æ–≤"
                },
                "–¢–∏–ø –æ–ø–ª–∞—Ç—ã": {
                    "type": ["string", "null"],
                    "enum": PAYMENT_TYPE + [None],
                    "description": "–¢–∏–ø —Å–∏—Å—Ç–µ–º—ã –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ (null = –Ω–µ —É–∫–∞–∑–∞–Ω–æ)"
                },
                "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)": {
                    "type": ["number", "null"],
                    "description": "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –æ–ø–ª–∞—Ç—ã"
                },
                "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)": {
                    "type": ["number", "null"],
                    "description": "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –æ–ø–ª–∞—Ç—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞)"
                },
                "–í–∞–ª—é—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã": {
                    "type": ["string", "null"],
                    "enum": SALARY_CURRENCY + [None],
                    "description": "–í–∞–ª—é—Ç–∞ –æ–ø–ª–∞—Ç—ã (null = –Ω–µ —É–∫–∞–∑–∞–Ω–æ)"
                },
                "–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞": {
                    "type": ["string", "null"],
                    "enum": CONTRACT_TYPE + [None],
                    "description": "–¢–∏–ø —Ç—Ä—É–¥–æ–≤–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞ (null = –Ω–µ —É–∫–∞–∑–∞–Ω–æ)"
                },
                "–ö–∞—Ä—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª—è": {
                    "type": ["string", "null"],
                    "enum": REQUIREMENT_LEVEL + [None],
                    "description": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ –∫–∞—Ä—Ç–µ –≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è —Ç–∞—Ö–æ–≥—Ä–∞—Ñ–∞"
                },
                "–¢–∏–ø —ç–∫–∏–ø–∞–∂–∞": {
                    "type": ["string", "null"],
                    "enum": CREW_TYPE + [None],
                    "description": "–¢—Ä–µ–±—É–µ–º—ã–π —Ç–∏–ø —ç–∫–∏–ø–∞–∂–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã (null = –ª—é–±–æ–π)"
                },
                "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞": {
                    "type": ["string", "null"],
                    "enum": POLISH_REQUIREMENT + [None],
                    "description": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ –≤–ª–∞–¥–µ–Ω–∏—é –ø–æ–ª—å—Å–∫–∏–º —è–∑—ã–∫–æ–º (null = –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)"
                },
                "–ì–æ—Ä–æ–¥ –±–∞–∑—ã": {
                    "type": ["string", "null"],
                    "description": "–ì–æ—Ä–æ–¥ –∏–ª–∏ —Ä–µ–≥–∏–æ–Ω, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –±–∞–∑–∞/—Å—Ç–æ—è–Ω–∫–∞"
                },
                "–î–æ–ø—É—Å—Ç–∏–º–æ–µ –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "–°–ø–∏—Å–æ–∫ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤ (—Ç–æ–ª—å–∫–æ —ç—Ç–∏). –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ = –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π"
                },
                "–ò—Å–∫–ª—é—á—ë–Ω–Ω–æ–µ –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "–°–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á—ë–Ω–Ω—ã—Ö –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤ (–∫—Ä–æ–º–µ —ç—Ç–∏—Ö). –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ = –Ω–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π"
                }
            },
            "required": [
                "–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∞–≤", "–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏", "–†–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã",
                "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç (–º–µ—Å—è—Ü—ã)", "–ö–æ–¥ 95", "ADR",
                "–¢–∏–ø –æ–ø–ª–∞—Ç—ã", "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)",
                "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)", "–í–∞–ª—é—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã",
                "–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞", "–ö–∞—Ä—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª—è",
                "–¢–∏–ø —ç–∫–∏–ø–∞–∂–∞", "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞", "–ì–æ—Ä–æ–¥ –±–∞–∑—ã",
                "–î–æ–ø—É—Å—Ç–∏–º–æ–µ –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ", "–ò—Å–∫–ª—é—á—ë–Ω–Ω–æ–µ –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ"
            ],
            "additionalProperties": False
        }
    },
    "required": ["page_id", "properties"],
    "additionalProperties": False
}

SYSTEM_PROMPT = f"""–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –æ –≤–∞–∫–∞–Ω—Å–∏—è—Ö –≤–æ–¥–∏—Ç–µ–ª–µ–π.

–¢–≤–æ—è –∑–∞–¥–∞—á–∞: –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏ –∏ –∏–∑–≤–ª–µ—á—å 17 –ø–æ–ª–µ–π —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º.

–ü–†–ê–í–ò–õ–ê –ò–ó–í–õ–ï–ß–ï–ù–ò–Ø –ü–û–õ–ï–ô:

1. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∞–≤** (multi_select, –º–∞—Å—Å–∏–≤):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞:" –≤ —Ä–∞–∑–¥–µ–ª–µ "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—É"
   –û–ø—Ü–∏–∏: {', '.join(LICENSE_CATEGORIES)}
   –í–ê–ñ–ù–û: BDF ‚Äî —ç—Ç–æ –¢–ò–ü –¢–ï–•–ù–ò–ö–ò (—Å–∏—Å—Ç–µ–º–∞ —Å–º–µ–Ω–Ω—ã—Ö –∫—É–∑–æ–≤–æ–≤), –∞ –ù–ï –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∞–≤! –ù–µ –ø—É—Ç–∞–π!
   –ü—Ä–∞–≤–∏–ª–∞:
   - –ò–∑–≤–ª–µ—á—å –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞
   - –†–∞–∑–¥–µ–ª–∏—Ç—å –ø–æ –∑–∞–ø—è—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ
   - –£–±—Ä–∞—Ç—å —Å–ª–æ–≤–æ "–ö–∞—Ç–µ–≥–æ—Ä–∏—è" –∏ –ø—Ä–æ–±–µ–ª—ã
   - "C+E", "C + E", "C/E" ‚Üí "CE"
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "BDF" –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–∞–≤ ‚Äî —ç—Ç–æ –æ—à–∏–±–∫–∞, BDF –∏–¥—ë—Ç –≤ "–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏"
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí [] (–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤, –Ω–æ —ç—Ç–æ —Ä–µ–¥–∫–æ—Å—Ç—å ‚Äî –ø—Ä–∞–≤–∞ –æ–±—ã—á–Ω–æ —É–∫–∞–∑–∞–Ω—ã)
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–ö–∞—Ç–µ–≥–æ—Ä–∏—è CE" ‚Üí ["CE"]
   - "–ö–∞—Ç–µ–≥–æ—Ä–∏—è C+E" ‚Üí ["CE"]
   - "–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞: –ö–∞—Ç–µ–≥–æ—Ä–∏—è B" ‚Üí ["B"]
   - "–ö–∞—Ç–µ–≥–æ—Ä–∏—è CE, BDF" ‚Üí ["CE"] (BDF –∏–¥—ë—Ç –≤ —Ç–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏!)

2. **–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏** (multi_select, –º–∞—Å—Å–∏–≤):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–ü—Ä–∏—Ü–µ–ø:", "–ê–≤—Ç–æ–º–æ–±–∏–ª—å:", –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ (–º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–∏–ø –≤ —Å–∫–æ–±–∫–∞—Ö)
   –û–ø—Ü–∏–∏: –¢–µ–Ω—Ç, –†–µ—Ñ (—Ä–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä), BDF, –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –¶–∏—Å—Ç–µ—Ä–Ω–∞, –ò–∑–æ—Ç–µ—Ä–º–∞, –®—Ç–æ—Ä–∞, –°–∞–º–æ—Å–≤–∞–ª, –¢–∞–Ω–¥–µ–º, –ü–æ–¥–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–π –ø—Ä–∏—Ü–µ–ø
   –ü—Ä–∞–≤–∏–ª–∞:
   - –ö–†–ò–¢–ò–ß–ù–û: –ò–∑–≤–ª–µ–∫–∞–π –¢–û–õ–¨–ö–û —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–∏–ø, –ù–ï —É–≥–∞–¥—ã–≤–∞–π!
   - –ò—â–∏ –≤ –±–ª–æ–∫–µ "–ü—Ä–∏—Ü–µ–ø:" —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "–¢–µ–Ω—Ç–æ–≤–∞–Ω–Ω—ã–π" –∏–ª–∏ "—Ç–µ–Ω—Ç" (–≤ –±–ª–æ–∫–µ –ü—Ä–∏—Ü–µ–ø) ‚Üí "–¢–µ–Ω—Ç"
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "–†–µ—Ñ" –∏–ª–∏ "—Ä–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä" –∏–ª–∏ "—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫" ‚Üí "–†–µ—Ñ (—Ä–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä)"
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "BDF" ‚Üí "BDF"
   - –ï—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "–¢–∞–Ω–¥–µ–º" ‚Üí "–¢–∞–Ω–¥–µ–º"
   - –ï—Å–ª–∏ "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π", "—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π", "–ù–µ—Ç", "–Ω–µ —É–∫–∞–∑–∞–Ω–æ", "–æ–±—ã—á–Ω—ã–π" ‚Üí [] (–ü–£–°–¢–û–ô –º–∞—Å—Å–∏–≤!)
   - –î–ª—è —Ñ—É—Ä–≥–æ–Ω–æ–≤ (Renault Master, Sprinter –∏ —Ç.–¥.) –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ ‚Üí []
   - –ù–ï –¥–æ–±–∞–≤–ª—è–π —Ç–∏–ø—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ —Ö—ç—à—Ç–µ–≥–æ–≤
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–ü—Ä–∏—Ü–µ–ø: BDF" ‚Üí ["BDF"]
   - "–ü—Ä–∏—Ü–µ–ø: –¢–µ–Ω—Ç–æ–≤–∞–Ω–Ω—ã–π" ‚Üí ["–¢–µ–Ω—Ç"]
   - "–ü—Ä–∏—Ü–µ–ø: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π" ‚Üí []
   - "–ü—Ä–∏—Ü–µ–ø: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π, –¥–æ 5 –ª–µ—Ç" ‚Üí []
   - "–ü—Ä–∏—Ü–µ–ø: –ù–µ—Ç" ‚Üí []
   - "–ê–≤—Ç–æ–º–æ–±–∏–ª—å: Renault Master" ‚Üí []

3. **–†–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã** (multi_select, –º–∞—Å—Å–∏–≤):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–†–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç—ã:" –∏–ª–∏ "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã/—Ä–µ–≥–∏–æ–Ω—ã:"
   
   –í–ê–ñ–ù–û - –ù–ê–ó–í–ê–ù–ò–Ø –°–¢–†–ê–ù:
   - –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –†–£–°–°–ö–ò–ï –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω
   - –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è - –ü–ï–†–ï–í–û–î–ò –∏—Ö –Ω–∞ —Ä—É—Å—Å–∫–∏–π
   - –ù–∞–ø—Ä–∏–º–µ—Ä: "Niemcy" ‚Üí "–ì–µ—Ä–º–∞–Ω–∏—è", "Francja" ‚Üí "–§—Ä–∞–Ω—Ü–∏—è", "Anglia" ‚Üí "–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è", "W≈Çochy" ‚Üí "–ò—Ç–∞–ª–∏—è"
   
   –ë–∞–∑–æ–≤—ã–µ –æ–ø—Ü–∏–∏: –ü–æ–ª—å—à–∞, –ü–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ, –°–∫–∞–Ω–¥–∏–Ω–∞–≤–∏—è, –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è, –ì–µ—Ä–º–∞–Ω–∏—è, –§—Ä–∞–Ω—Ü–∏—è, –ò—Ç–∞–ª–∏—è, –ò—Å–ø–∞–Ω–∏—è, –ë–µ–Ω–∏–ª—é–∫—Å, –ß–µ—Ö–∏—è, –°–ª–æ–≤–∞–∫–∏—è, –ê–≤—Å—Ç—Ä–∏—è, –í–µ–Ω–≥—Ä–∏—è, –õ–∏—Ç–≤–∞, –õ–∞—Ç–≤–∏—è, –≠—Å—Ç–æ–Ω–∏—è, –°–ª–æ–≤–µ–Ω–∏—è, –ì—Ä–µ—Ü–∏—è, –ë–æ–ª–≥–∞—Ä–∏—è, –î–∞–Ω–∏—è, –®–≤–µ—Ü–∏—è, –§–∏–Ω–ª—è–Ω–¥–∏—è, –ù–æ—Ä–≤–µ–≥–∏—è, –®–≤–µ–π—Ü–∞—Ä–∏—è, –†—É–º—ã–Ω–∏—è, –•–æ—Ä–≤–∞—Ç–∏—è, –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã, –ë–µ–ª—å–≥–∏—è, –õ—é–∫—Å–µ–º–±—É—Ä–≥, –ü–æ—Ä—Ç—É–≥–∞–ª–∏—è, –í–æ—Å—Ç–æ—á–Ω–∞—è –ï–≤—Ä–æ–ø–∞, –ó–∞–ø–∞–¥–Ω–∞—è –ï–≤—Ä–æ–ø–∞
   
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–ø–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ", "–≤—Å—è –ï–≤—Ä–æ–ø–∞", "EU", "UE", "–ï–≤—Ä–æ–ø–∞", "–ø–æ –ï–°" ‚Üí ["–ü–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ"]
   - –ï—Å–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã —Å—Ç—Ä–∞–Ω—ã ‚Üí –∏–∑–≤–ª–µ—á—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–∞–Ω—É –û–¢–î–ï–õ–¨–ù–û –Ω–∞ –†–£–°–°–ö–û–ú —è–∑—ã–∫–µ
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ª—é–±—ã–µ —Å—Ç—Ä–∞–Ω—ã/—Ä–µ–≥–∏–æ–Ω—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ, –ù–û –¢–û–õ–¨–ö–û –ù–ê –†–£–°–°–ö–û–ú
   
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí [] (–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ = –ª—é–±—ã–µ —Ä–µ–≥–∏–æ–Ω—ã)
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–ø–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ" ‚Üí ["–ü–æ –≤—Å–µ–π –ï–≤—Ä–æ–ø–µ"]
   - "Niemcy, Francja" ‚Üí ["–ì–µ—Ä–º–∞–Ω–∏—è", "–§—Ä–∞–Ω—Ü–∏—è"]
   - "–ì–µ—Ä–º–∞–Ω–∏—è, –ß–µ—Ö–∏—è, –ê–≤—Å—Ç—Ä–∏—è, –ü–æ–ª—å—à–∞" ‚Üí ["–ì–µ—Ä–º–∞–Ω–∏—è", "–ß–µ—Ö–∏—è", "–ê–≤—Å—Ç—Ä–∏—è", "–ü–æ–ª—å—à–∞"]

4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç (–º–µ—Å—è—Ü—ã)** (number):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã:" –∏–ª–∏ "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã:" –≤ —Ä–∞–∑–¥–µ–ª–µ "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—É"
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–ü–æ–ª–≥–æ–¥–∞" ‚Üí 6
   - "6 –º–µ—Å—è—Ü–µ–≤" ‚Üí 6
   - "1 –≥–æ–¥" ‚Üí 12
   - "2 –≥–æ–¥–∞" ‚Üí 24
   - "3 –≥–æ–¥–∞" ‚Üí 36
   - "–ñ–µ–ª–∞—Ç–µ–ª–µ–Ω 6 –º–µ—Å—è—Ü–µ–≤" ‚Üí 6 (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ –∫–∞–∫ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –≤—Å–µ —Ä–∞–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å)
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

5. **–ö–æ–¥ 95** (select, —Å—Ç—Ä–æ–∫–∞):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–æ–¥ 95):"
   –û–ø—Ü–∏–∏: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
   - "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ"
   - "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", "–ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è", –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null (–ø—É—Å—Ç–æ–µ = –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

6. **ADR** (select, —Å—Ç—Ä–æ–∫–∞):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "ADR (–æ–ø–∞—Å–Ω—ã–µ –≥—Ä—É–∑—ã):" –∏–ª–∏ "ADR (–ø–µ—Ä–µ–≤–æ–∑–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö –≥—Ä—É–∑–æ–≤):"
   –û–ø—Ü–∏–∏: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
   - "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ" –∏–ª–∏ "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ"
   - "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null (–ø—É—Å—Ç–æ–µ = –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

7. **–¢–∏–ø –æ–ø–ª–∞—Ç—ã** (select, —Å—Ç—Ä–æ–∫–∞):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–°–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã:" –∏–ª–∏ "–û–ø–ª–∞—Ç–∞:" –≤ —Ä–∞–∑–¥–µ–ª–µ –æ–ø–ª–∞—Ç—ã
   –û–ø—Ü–∏–∏: –ü–æ–¥–µ–Ω–Ω–∞—è, –ú–µ—Å—è—á–Ω–∞—è
   –ü—Ä–∞–≤–∏–ª–∞:
   - "–ü–æ–¥–µ–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞", "–¥–Ω–∏√≥wka", "–∑–∞ –¥–µ–Ω—å", "–≤ –¥–µ–Ω—å", "/–¥–µ–Ω—å", "/dzien" ‚Üí "–ü–æ–¥–µ–Ω–Ω–∞—è"
   - "–ï–∂–µ–º–µ—Å—è—á–Ω–∞—è", "–†–∞–∑ –≤ –º–µ—Å—è—Ü", "–≤ –º–µ—Å—è—Ü", "–∑–∞ –º–µ—Å—è—Ü", "–º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞" ‚Üí "–ú–µ—Å—è—á–Ω–∞—è"
   - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ –¥–Ω–µ–≤–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ ‚Üí "–ü–æ–¥–µ–Ω–Ω–∞—è"
   - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ –º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ ‚Üí "–ú–µ—Å—è—á–Ω–∞—è"
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

8. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)** (number):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–û–ø–ª–∞—Ç–∞:", "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞:", "–°—Ä–µ–¥–Ω—è—è –º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ):", "–°–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã:"
   –ü—Ä–∞–≤–∏–ª–∞:
   - –ò—â–∏ —á–∏—Å–ª–∞ —Ä—è–¥–æ–º —Å–æ —Å–ª–æ–≤–∞–º–∏ "–∑–ª–æ—Ç—ã—Ö", "z≈Ç", "‚Ç¨", "EUR", "–Ω–µ—Ç—Ç–æ", "—Å—Ç–∞–≤–∫–∞", "–∑–∞—Ä–ø–ª–∞—Ç–∞"
   - –ï—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω (300-320) ‚Üí –≤–∑—è—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (300)
   - –î–ª—è –ø–æ–¥–µ–Ω–Ω–æ–π: –∏–∑ "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞:" –∏–ª–∏ "–ü–æ–¥–µ–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞"
   - –î–ª—è –º–µ—Å—è—á–Ω–æ–π: –∏–∑ "–°—Ä–µ–¥–Ω—è—è –º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ):"
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞: 430 –ø–æ–ª—å—Å–∫–∏—Ö –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ –∑–∞ –¥–µ–Ω—å" ‚Üí 430
   - "–ü–æ–¥–µ–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞ ‚Äì 450 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí 450
   - "300-320 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí 300
   - "95‚Ç¨/–¥–µ–Ω—å" ‚Üí 95
   - "3000 –µ–≤—Ä–æ –∑–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Ä–∞–±–æ—Ç—É" ‚Üí 3000

9. **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ)** (number –∏–ª–∏ null):
   –ò—Å—Ç–æ—á–Ω–∏–∫: –¢–æ—Ç –∂–µ, —á—Ç–æ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è
   –ü—Ä–∞–≤–∏–ª–∞:
   - –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
   - –ï—Å–ª–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ ‚Üí null
   - –ï—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω ‚Üí –∏–∑–≤–ª–µ—á—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
   –ü—Ä–∏–º–µ—Ä—ã:
   - "300-320 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí 320
   - "400-450 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí 450
   - "450 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí null

10. **–í–∞–ª—é—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã** (select, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–û–ø–ª–∞—Ç–∞:", "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞:", "–°—Ä–µ–¥–Ω—è—è –º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–Ω–µ—Ç—Ç–æ):"
    –û–ø—Ü–∏–∏: PLN, EUR
    –ü—Ä–∞–≤–∏–ª–∞:
    - "–∑–ª–æ—Ç—ã—Ö", "z≈Ç", "PLN", "–ø–æ–ª—å—Å–∫–∏—Ö –∑–ª–æ—Ç—ã—Ö" ‚Üí "PLN"
    - "‚Ç¨", "EUR", "–µ–≤—Ä–æ", "euro" ‚Üí "EUR"
    - –ï—Å–ª–∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞ ‚Üí null
    –ü—Ä–∏–º–µ—Ä—ã:
    - "–°—Ä–µ–¥–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞: 430 –ø–æ–ª—å—Å–∫–∏—Ö –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ –∑–∞ –¥–µ–Ω—å" ‚Üí "PLN"
    - "300-320 –∑–ª–æ—Ç—ã—Ö –Ω–µ—Ç—Ç–æ" ‚Üí "PLN"
    - "95‚Ç¨/–¥–µ–Ω—å" ‚Üí "EUR"

11. **–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞** (select, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞:" –≤ –Ω–∞—á–∞–ª–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    –û–ø—Ü–∏–∏: UMOWA O PRACƒò, UMOWA ZLECENIE, B2B
    –ü—Ä–∞–≤–∏–ª–∞:
    - "UMOWA O PRACƒò" –∏–ª–∏ "–¢—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä" –∏–ª–∏ "umowa o pracƒô" –∏–ª–∏ "UOP" ‚Üí "UMOWA O PRACƒò"
    - "UMOWA ZLECENIE" –∏–ª–∏ "UZ" ‚Üí "UMOWA ZLECENIE"
    - "B2B" ‚Üí "B2B"
    - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

12. **–ö–∞—Ä—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª—è** (select, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –ë–ª–æ–∫ "–ö–∞—Ä—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª—è (–¥–ª—è —Ç–∞—Ö–æ–≥—Ä–∞—Ñ–∞):" –≤ —Ä–∞–∑–¥–µ–ª–µ "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—É"
    –û–ø—Ü–∏–∏: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ
    –ü—Ä–∞–≤–∏–ª–∞:
    - "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
    - "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ" ‚Üí "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ"
    - "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", "–ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è", –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null (–ø—É—Å—Ç–æ–µ = –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

13. **–¢–∏–ø —ç–∫–∏–ø–∞–∂–∞** (select, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –¢–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏, —Ä–∞–∑–¥–µ–ª —É—Å–ª–æ–≤–∏–π —Ä–∞–±–æ—Ç—ã –∏–ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
    –û–ø—Ü–∏–∏: —Å–æ–ª–æ, –ø–∞—Ä–Ω—ã–π
    –ü—Ä–∞–≤–∏–ª–∞:
    - "–û–¥–∏–Ω–æ—á–Ω—ã–π", "–æ–¥–∏–Ω –≤–æ–¥–∏—Ç–µ–ª—å", "—Å–æ–ª–æ", "Solo" ‚Üí "—Å–æ–ª–æ"
    - "–ü–∞—Ä–Ω—ã–π —ç–∫–∏–ø–∞–∂", "–≤ –¥–≤–æ–π–∫–µ", "–¥–≤–∞ –≤–æ–¥–∏—Ç–µ–ª—è", "—Å–µ–º–µ–π–Ω—ã–π —ç–∫–∏–ø–∞–∂", "–º—É–∂ –∏ –∂–µ–Ω–∞" ‚Üí "–ø–∞—Ä–Ω—ã–π"
    - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–ª–∏ "–ª—é–±–æ–π —ç–∫–∏–ø–∞–∂" ‚Üí null
    –í–ê–ñ–ù–û: "—Å–µ–º–µ–π–Ω—ã–π —ç–∫–∏–ø–∞–∂" = "–ø–∞—Ä–Ω—ã–π" (–¥–≤–∞ –≤–æ–¥–∏—Ç–µ–ª—è)
    –ü—Ä–∏–º–µ—Ä—ã:
    - "–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–∞—Ä–Ω—ã–π —ç–∫–∏–ø–∞–∂" ‚Üí "–ø–∞—Ä–Ω—ã–π"
    - "–°–µ–º–µ–π–Ω—ã–π —ç–∫–∏–ø–∞–∂ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è" ‚Üí "–ø–∞—Ä–Ω—ã–π"
    - –ù–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

14. **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞** (select, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –¢–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏, —Ä–∞–∑–¥–µ–ª —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—É
    –û–ø—Ü–∏–∏: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ
    –ü—Ä–∞–≤–∏–ª–∞:
    - "–ü–æ–ª—å—Å–∫–∏–π –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω", "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ –ø–æ–ª—å—Å–∫–æ–≥–æ" ‚Üí "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
    - "–ü–æ–ª—å—Å–∫–∏–π –∂–µ–ª–∞—Ç–µ–ª–µ–Ω", "–∑–Ω–∞–Ω–∏–µ –ø–æ–ª—å—Å–∫–æ–≥–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è", "—Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å" ‚Üí "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ"
    - –í–ê–ñ–ù–û: –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω –≤—ã–±–æ—Ä –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤ ("—Ä—É—Å—Å–∫–∏–π, –ø–æ–ª—å—Å–∫–∏–π –ò–õ–ò –∞–Ω–≥–ª–∏–π—Å–∫–∏–π", "—Ä—É—Å—Å–∫–∏–π/–ø–æ–ª—å—Å–∫–∏–π/–∞–Ω–≥–ª–∏–π—Å–∫–∏–π") ‚Üí null (–ø–æ–ª—å—Å–∫–∏–π –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª—é–±–æ–≥–æ)
    - "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", "–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ", "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –±–µ–∑ –∑–Ω–∞–Ω–∏—è –ø–æ–ª—å—Å–∫–æ–≥–æ: –î–∞" ‚Üí null
    - –ù–µ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è ‚Üí null
    –ü—Ä–∏–º–µ—Ä—ã:
    - "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ –ø–æ–ª—å—Å–∫–æ–≥–æ" ‚Üí "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
    - "–ó–Ω–∞–Ω–∏–µ –ø–æ–ª—å—Å–∫–æ–≥–æ: —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å" ‚Üí "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ"
    - "–û–±—è–∑–∞—Ç–µ–ª–µ–Ω —Ä—É—Å—Å–∫–∏–π, –ø–æ–ª—å—Å–∫–∏–π –∏–ª–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π" ‚Üí null (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–≥–æ –∏–∑ —è–∑—ã–∫–æ–≤)
    - "–ó–Ω–∞–Ω–∏–µ –ø–æ–ª—å—Å–∫–æ–≥–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" ‚Üí null
    - "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –±–µ–∑ –∑–Ω–∞–Ω–∏—è –ø–æ–ª—å—Å–∫–æ–≥–æ: –î–∞" ‚Üí null
    - –ù–µ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è ‚Üí null

15. **–ì–æ—Ä–æ–¥ –±–∞–∑—ã** (text, —Å—Ç—Ä–æ–∫–∞):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏, –±–ª–æ–∫ "–ë–∞–∑–∞:", "–ú–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã (–±–∞–∑–∞):", "Lokalizacja:", –∞–¥—Ä–µ—Å –∫–æ–º–ø–∞–Ω–∏–∏
    –§–æ—Ä–º–∞—Ç: –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –¢–û–õ–¨–ö–û –Ω–∞ –ø–æ–ª—å—Å–∫–æ–º —è–∑—ã–∫–µ (–ª–∞—Ç–∏–Ω–∏—Ü–∞)
    –ü—Ä–∞–≤–∏–ª–∞:
    - –ò–∑–≤–ª–µ—á—å –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ –±–ª–æ–∫–∞ "–ú–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã (–±–∞–∑–∞):" –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–∏
    - –í–ê–ñ–ù–û: –ï—Å–ª–∏ –≥–æ—Ä–æ–¥ —É–∫–∞–∑–∞–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞) ‚Üí –ü–ï–†–ï–í–ï–°–¢–ò –Ω–∞ –ø–æ–ª—å—Å–∫–∏–π (–ª–∞—Ç–∏–Ω–∏—Ü–∞)
    - –£–±—Ä–∞—Ç—å –∏–Ω–¥–µ–∫—Å –∏ –ª–∏—à–Ω–∏–µ —Å–ª–æ–≤–∞, –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞
    - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Ç–æ–ª—å–∫–æ —Ä–µ–≥–∏–æ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥–∏–æ–Ω
    - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null
    –ü—Ä–∏–º–µ—Ä—ã:
    - "–ú–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã (–±–∞–∑–∞): 34-240 –ô–æ—Ä–¥–∞–Ω—É–≤" ‚Üí "Jordan√≥w"
    - "–ú–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã (–±–∞–∑–∞): –ö—Ä–∞–∫–æ–≤" ‚Üí "Krak√≥w"
    - "–ú–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã (–±–∞–∑–∞): –õ–æ–¥–∑—å" ‚Üí "≈Å√≥d≈∫"
    - "Miejsce pracy: Pozna≈Ñ" ‚Üí "Pozna≈Ñ"
    - "–ë–∞–∑–∞: –í–∞—Ä—à–∞–≤–∞" ‚Üí "Warszawa"
    - –ù–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí null

16. **–î–æ–ø—É—Å—Ç–∏–º–æ–µ –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ** (multi_select, –º–∞—Å—Å–∏–≤):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –¢–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏, —Ä–∞–∑–¥–µ–ª —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
    –ü—Ä–∞–≤–∏–ª–∞:
    - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ "—Ç–æ–ª—å–∫–æ –≥—Ä–∞–∂–¥–∞–Ω–µ –£–∫—Ä–∞–∏–Ω—ã" ‚Üí ["–£–∫—Ä–∞–∏–Ω–∞"]
    - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ "–≥—Ä–∞–∂–¥–∞–Ω–µ –°–ù–ì" ‚Üí ["–£–∫—Ä–∞–∏–Ω–∞", "–ë–µ–ª–∞—Ä—É—Å—å", "–ú–æ–ª–¥–æ–≤–∞", "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω", "–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω", "–¢–∞–¥–∂–∏–∫–∏—Å—Ç–∞–Ω", "–ì—Ä—É–∑–∏—è", "–ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω", "–ê—Ä–º–µ–Ω–∏—è", "–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω"]
    - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ "—Ç–æ–ª—å–∫–æ –≥—Ä–∞–∂–¥–∞–Ω–µ –£–∫—Ä–∞–∏–Ω—ã –∏ –ë–µ–ª–∞—Ä—É—Å–∏" ‚Üí ["–£–∫—Ä–∞–∏–Ω–∞", "–ë–µ–ª–∞—Ä—É—Å—å"]
    - "—Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ", "—Ä—É—Å—Å–∫–æ–≥–æ–≤–æ—Ä—è—â–∏–µ", "–¥–ª—è —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö" ‚Üí ["–£–∫—Ä–∞–∏–Ω–∞", "–ë–µ–ª–∞—Ä—É—Å—å"]
    - –ï—Å–ª–∏ –Ω–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí [] (–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)
    - –í–ê–ñ–ù–û: –ü–æ–ª–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω –Ω–∞ –†–£–°–°–ö–û–ú —è–∑—ã–∫–µ
    –ü—Ä–∏–º–µ—Ä—ã:
    - "–¢–æ–ª—å–∫–æ –¥–ª—è –≥—Ä–∞–∂–¥–∞–Ω –£–∫—Ä–∞–∏–Ω—ã" ‚Üí ["–£–∫—Ä–∞–∏–Ω–∞"]
    - "–ü—Ä–∏–Ω–∏–º–∞–µ–º –≥—Ä–∞–∂–¥–∞–Ω –£–∫—Ä–∞–∏–Ω—ã, –ë–µ–ª–∞—Ä—É—Å–∏" ‚Üí ["–£–∫—Ä–∞–∏–Ω–∞", "–ë–µ–ª–∞—Ä—É—Å—å"]
    - "–î–ª—è —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö –≤–æ–¥–∏—Ç–µ–ª–µ–π" ‚Üí ["–£–∫—Ä–∞–∏–Ω–∞", "–ë–µ–ª–∞—Ä—É—Å—å"]
    - –ù–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí []

17. **–ò—Å–∫–ª—é—á—ë–Ω–Ω–æ–µ –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ** (multi_select, –º–∞—Å—Å–∏–≤):
    –ò—Å—Ç–æ—á–Ω–∏–∫: –¢–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏, —Ä–∞–∑–¥–µ–ª —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
    –ü—Ä–∞–≤–∏–ª–∞:
    - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ "–±–µ–∑ –≥—Ä–∞–∂–¥–∞–Ω –†–§" ‚Üí ["–†–æ—Å—Å–∏—è"]
    - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ "–∫—Ä–æ–º–µ –≥—Ä–∞–∂–¥–∞–Ω –†—É–º—ã–Ω–∏–∏" ‚Üí ["–†—É–º—ã–Ω–∏—è"]
    - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ "–Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –∏–∑ –†–æ—Å—Å–∏–∏ –∏ –ë–µ–ª–∞—Ä—É—Å–∏" ‚Üí ["–†–æ—Å—Å–∏—è", "–ë–µ–ª–∞—Ä—É—Å—å"]
    - –ï—Å–ª–∏ –Ω–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí [] (–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)
    - –í–ê–ñ–ù–û: –ü–æ–ª–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω –Ω–∞ –†–£–°–°–ö–û–ú —è–∑—ã–∫–µ
    –ü—Ä–∏–º–µ—Ä—ã:
    - "–ë–µ–∑ –≥—Ä–∞–∂–¥–∞–Ω –†–§" ‚Üí ["–†–æ—Å—Å–∏—è"]
    - "–ù–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≥—Ä–∞–∂–¥–∞–Ω –†–æ—Å—Å–∏–∏ –∏ –†—É–º—ã–Ω–∏–∏" ‚Üí ["–†–æ—Å—Å–∏—è", "–†—É–º—ã–Ω–∏—è"]
    - –ù–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí []

–û–ë–©–ò–ï –ü–†–ê–í–ò–õ–ê:
- –ï—Å–ª–∏ –±–ª–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ –ø—Ä–∞–≤–∏–ª –ø–æ–ª—è –≤—ã—à–µ
- –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ "–ù–µ —É–∫–∞–∑–∞–Ω–æ" –∏–ª–∏ "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –î–ª—è multi_select (–º–∞—Å—Å–∏–≤—ã): –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí []
- –î–ª—è select (—Å—Ç—Ä–æ–∫–∏): —Å–ª–µ–¥—É–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º –ø–æ–ª—è (null, "–ù–µ —É–∫–∞–∑–∞–Ω–æ", "–õ—é–±–æ–π" –∏–ª–∏ "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è")
- –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ ‚Üí –≤—ã–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π
- –°—Ç—Ä–æ–≥–æ —Å–ª–µ–¥—É–π —Å—Ö–µ–º–µ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–ø—Ü–∏—è–º
- –í–ê–ñ–ù–û: –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –æ–±—â–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏
"""

def call_openai_api(vacancy_data, page_id):
    """–í—ã–∑—ã–≤–∞–µ—Ç OpenAI API –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç tuple: (result, error_message)
    - –ü—Ä–∏ —É—Å–ø–µ—Ö–µ: (extracted_data, None)
    - –ü—Ä–∏ –æ—à–∏–±–∫–µ: (None, "–æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏")
    """
    
    # –ë–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç (–æ—Ä–∏–≥–∏–Ω–∞–ª –≤–∞–∫–∞–Ω—Å–∏–∏), –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º "–ü–æ—Å—Ç"
    child_pages = vacancy_data.get('child_pages', [])
    if not child_pages:
        return None, "–Ω–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"
    
    vacancy_text = child_pages[0].get('content', '')
    
    if not vacancy_text.strip():
        return None, "–ø—É—Å—Ç–∞—è –≤–∞–∫–∞–Ω—Å–∏—è"
    
    user_message = f"–í–∞–∫–∞–Ω—Å–∏—è ID: {page_id}\n\n{vacancy_text}"
    
    try:
        response = client.beta.chat.completions.parse(
            model="gpt-4o-mini",
            messages=[
                {"role": "system", "content": SYSTEM_PROMPT},
                {"role": "user", "content": user_message}
            ],
            temperature=0.1,
            response_format={
                "type": "json_schema",
                "json_schema": {
                    "name": "vacancy_extraction",
                    "strict": True,
                    "schema": RESPONSE_SCHEMA
                }
            }
        )
        
        content = response.choices[0].message.content
        extracted_data = json.loads(content)
        
        # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ page_id –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
        extracted_data['page_id'] = page_id
        
        return extracted_data, None
        
    except Exception as e:
        error_msg = str(e)
        if hasattr(e, 'response'):
            try:
                error_msg += f" | {e.response.text}"
            except:
                pass
        return None, f"API: {error_msg}"

def main():
    parser = argparse.ArgumentParser(description='–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π —á–µ—Ä–µ–∑ GPT-4o mini')
    parser.add_argument('--batch-size', type=int, default=5, help='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞ —Ä–∞–∑')
    parser.add_argument('--start-from', type=int, default=0, help='–ù–∞—á–∞—Ç—å —Å –≤–∞–∫–∞–Ω—Å–∏–∏ –Ω–æ–º–µ—Ä N')
    parser.add_argument('--vacancies-file', default='vacancies.json', help='–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –≤–∞–∫–∞–Ω—Å–∏—è–º–∏')
    parser.add_argument('--output-dir', default='patches/', help='–ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤')
    
    args = parser.parse_args()
    
    # –°–æ–∑–¥–∞–µ–º –≤—ã—Ö–æ–¥–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
    os.makedirs(args.output_dir, exist_ok=True)
    
    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —Å –≤–∞–∫–∞–Ω—Å–∏—è–º–∏
    print(f"üì• –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π –∏–∑ {args.vacancies_file}...")
    try:
        with open(args.vacancies_file, 'r', encoding='utf-8') as f:
            vacancies = json.load(f)
    except FileNotFoundError:
        print(f"‚ùå –§–∞–π–ª {args.vacancies_file} –Ω–µ –Ω–∞–π–¥–µ–Ω")
        sys.exit(1)
    except json.JSONDecodeError as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: {e}")
        sys.exit(1)
    
    total_vacancies = len(vacancies)
    print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {total_vacancies} –≤–∞–∫–∞–Ω—Å–∏–π")
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏
    start_idx = args.start_from
    end_idx = min(start_idx + args.batch_size, total_vacancies)
    
    if start_idx >= total_vacancies:
        print(f"‚ùå –ò–Ω–¥–µ–∫—Å –Ω–∞—á–∞–ª–∞ ({start_idx}) –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤–∞–∫–∞–Ω—Å–∏–π ({total_vacancies})")
        sys.exit(1)
    
    print(f"\nüîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π —Å {start_idx} –ø–æ {end_idx - 1} (–±–∞—Ç—á —Ä–∞–∑–º–µ—Ä–æ–º {args.batch_size})")
    print(f"üìÇ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {args.output_dir}")
    print(f"‚ö° –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: 5 –≤–∞–∫–∞–Ω—Å–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –∑–∞–¥–µ—Ä–∂–∫–∞ 5 —Å–µ–∫ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏\n")
    
    success_count = 0
    error_count = 0
    skipped_count = 0
    
    def process_vacancy(idx, vacancy):
        page_id = vacancy.get('page_id')
        
        if not page_id:
            return idx, None, "–Ω–µ—Ç page_id"
        
        output_file = os.path.join(args.output_dir, f"vacancy-{page_id}.json")
        if os.path.exists(output_file):
            return idx, page_id, "skipped"
        
        result, error = call_openai_api(vacancy, page_id)
        
        if result:
            try:
                with open(output_file, 'w', encoding='utf-8') as f:
                    json.dump(result, f, ensure_ascii=False, indent=2)
                return idx, page_id, "success"
            except Exception as e:
                return idx, page_id, f"–æ—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {e}"
        else:
            return idx, page_id, error or "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"
    
    parallel_batch_size = 5
    vacancies_to_process = list(range(start_idx, end_idx))
    
    for batch_start in range(0, len(vacancies_to_process), parallel_batch_size):
        batch_end = min(batch_start + parallel_batch_size, len(vacancies_to_process))
        batch_indices = vacancies_to_process[batch_start:batch_end]
        
        print(f"üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –±–∞—Ç—á: –≤–∞–∫–∞–Ω—Å–∏–∏ {batch_indices[0] + 1}-{batch_indices[-1] + 1} –∏–∑ {total_vacancies}")
        
        batch_had_api_calls = False
        
        with ThreadPoolExecutor(max_workers=5) as executor:
            futures = {
                executor.submit(process_vacancy, idx, vacancies[idx]): idx 
                for idx in batch_indices
            }
            
            for future in as_completed(futures):
                idx, page_id, status = future.result()
                
                if status == "success":
                    print(f"  ‚úÖ {idx + 1}: {page_id[:8]}... —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ")
                    success_count += 1
                    batch_had_api_calls = True
                elif status == "skipped":
                    print(f"  ‚è≠Ô∏è  {idx + 1}: {page_id[:8]}... —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
                    skipped_count += 1
                elif status == "–Ω–µ—Ç page_id":
                    print(f"  ‚ö†Ô∏è  {idx + 1}: –Ω–µ—Ç page_id, –ø—Ä–æ–ø—É—â–µ–Ω–æ")
                    error_count += 1
                else:
                    print(f"  ‚ùå {idx + 1}: {page_id[:8] if page_id else 'N/A'}... {status}")
                    error_count += 1
                    batch_had_api_calls = True
        
        if batch_end < len(vacancies_to_process) and batch_had_api_calls:
            print(f"  ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ 5 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –±–∞—Ç—á–µ–º...")
            time.sleep(5)
    
    print(f"\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    print(f"  ‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {success_count}")
    print(f"  ‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (—É–∂–µ –µ—Å—Ç—å): {skipped_count}")
    print(f"  ‚ùå –û—à–∏–±–æ–∫: {error_count}")
    print(f"  üì¶ –í—Å–µ–≥–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ: {end_idx - start_idx}")
    
    if end_idx < total_vacancies:
        print(f"\nüí° –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–∞—Ç—á–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:")
        print(f"   python3 process_with_gpt.py --start-from {end_idx} --batch-size {args.batch_size}")
    else:
        print(f"\nüéâ –í—Å–µ –≤–∞–∫–∞–Ω—Å–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã!")

if __name__ == "__main__":
    main()

